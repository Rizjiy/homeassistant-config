homeassistant:
  # Name of the location where Home Assistant is running
  name: Home
  # Location required to calculate the time the sun rises and sets
  latitude: !secret home_latitude
  longitude: !secret home_longitude
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: 123
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/Moscow
  
  customize: !include customize.yaml
  
  auth_providers:
    - type: homeassistant
    # - type: legacy_api_password
    - type: trusted_networks
      trusted_networks:
        - 192.168.88.0/24

group: !include groups.yaml
script: !include scripts.yaml
automation: !include automations.yaml
intent_script: !include intent_scripts.yaml
zone: !include zones.yaml

input_datetime: !include input_datetime.yaml
input_number: !include input_number.yaml

scene: !include scenes.yaml

# Show links to resources in log and frontend
#introduction:

# Enables the frontend
frontend:

# lovelace:
#   mode: yaml

# Enables configuration UI
config:

# default_config:

http:
  # api_password: !secret http_password
  ssl_certificate: /ssl/fullchain.pem
  ssl_key: /ssl/privkey.pem

# Checks for available updates
updater:

# Discover some devices automatically
discovery:
  ignore:
  - igd

# Allows you to issue voice commands from the frontend in enabled browsers
conversation:

# Enables support for tracking state changes over time.
history:

# View all events in a logbook
logbook:
  exclude:
    domains:
    - sensor

# Enables a map showing the location of tracked devices
map:

# Track the sun
sun:

system_health:

person:
      
device_tracker:
  - platform: snmp
    host: 192.168.88.1
    community: !secret snmp_comunity 
    baseoid: 1.3.6.1.4.1.14988.1.1.1.2.1.1
    interval_seconds: 30
    # consider_home: 120
    new_device_defaults:
      track_new_devices: false
  - platform: google_maps
    username: rodal2807.home@gmail.com

# Weather Prediction
weather:
  - platform: openweathermap
    api_key: !secret openweather_apikey
    mode: daily

sensor:
  - platform: time_date
    display_options:
    - 'time'
    # - 'date'
    # - 'date_time'
    # - 'time_utc'
    # - 'time_date'
    # - 'beat'
      
  - platform: yr
  
  - platform: mqtt
    state_topic: 'home/livingroom/dht'
    name: temperature
    unit_of_measurement: '°C'
    value_template: '{{ value_json.temperature }}'
    
  - platform: mqtt
    state_topic: 'home/livingroom/dht'
    name: humidity
    unit_of_measurement: '%'
    value_template: '{{ value_json.humidity }}'

  - platform: mqtt
    state_topic: "valetudo/rockrobo/state"
    json_attributes_topic: "valetudo/rockrobo/map_data"
    name: xiaomi_map
    value_template: 'OK'
    scan_interval: 5
    
  # - platform: filter
    # name: "filtered humidity"
    # entity_id: sensor.Humidity
    # filters:
      # - filter: outlier
        # window_size: 4
        # radius: 4.0
      # - filter: lowpass
        # time_constant: 10
        # precision: 2    

light:
# подсветка кухни
  - platform: mqtt
    name: kitchen_worktop
    state_topic: "home/kitchen/switch/worktop/state"
    command_topic: "home/kitchen/switch/worktop"
    payload_on: 1
    payload_off: 0
    qos: 0
# лампа на кухне
  - platform: mqtt
    name: kitchen_table
    state_topic: "home/kitchen/switch2/table/state"
    command_topic: "home/kitchen/switch2/table"
    payload_on: 1
    payload_off: 0
    qos: 0
# свет в ванной
  - platform: mqtt
    name: bathroom_mirror
    state_topic: "home/bathroom/switch/mirror/state"
    command_topic: "home/bathroom/switch/mirror"
    payload_on: 1
    payload_off: 0
    qos: 0  

switch:
# подсветка растений
  - platform: mqtt
    name: kitchen_plants
    state_topic: "home/kitchen/switch2/plants/state"
    command_topic: "home/kitchen/switch2/plants"
    payload_on: 1
    payload_off: 0
    qos: 0
    retain: true
# теплый пол    
  - platform: mqtt
    name: hall_warmfloor
    state_topic: "home/hall/switch/warmfloor/state"
    command_topic: "home/hall/switch/warmfloor"
    payload_on: 1
    payload_off: 0
    qos: 0
    retain: true
#автополив
  - platform: mqtt
    name: autowatering  
    state_topic: "home/kitchen/switch2/waterpump/state"
    command_topic: "home/trigger/kitchen/switch2/waterpump"
    payload_on: 1
    payload_off: 0
    state_on: 1
    state_off: 0
    qos: 0     

vacuum:
  - platform: xiaomi_miio
    host: 192.168.88.12
    token: 7850526464756e5847514a6b414c346b
    name: xiaomi_vacuum


tts:
  platform: google_translate
  language: 'ru'
  cache: true
  cache_dir: /tmp/tts
  time_memory: 300
  

mqtt:
  broker: rodal2807.synology.me
  port: 1883
  protocol: 3.1.1
  client_id: home-assistant
  username: !secret mqtt_login
  password: !secret mqtt_password
  discovery: true
  discovery_prefix: homeassistant
  
recorder:
  exclude:
    entities:
      - sensor.xiaomi_map


# logger:
  # default: error
  # logs:
   # homeassistant.components.device_tracker: debug
  
dialogflow:

google_assistant:
  project_id: homeassistant-2807
  api_key: !secret google_assistant_api_key

yandex_smart_home:   
  filter:
    include_domains:
      - switch
      - light
      - script
    include_entities:
      - vacuum.xiaomi_vacuum
  entity_config:
    light.kitchen_worktop:
      room: 'Кухня'
    light.kitchen_table:
      room: 'Кухня'
    light.bathroom_mirror:
      room: 'Ванная'
    switch.kitchen_plants:
      room: 'Кухня'
    switch.hall_warmfloor:
      room: 'Ванная'
    vacuum.xiaomi_vacuum:
      room: 'Гостиная'
    script.vacuum_kitchen:
      room: 'Кухня'
    script.vacuum_guest_room:
      room: 'Гостиная'  
    
    
    
    
    